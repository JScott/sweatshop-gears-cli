#!/usr/bin/env ruby
require 'yaml'
require 'commander/import'
require 'robot_sweatshop/gears'

program :name, 'Sweatshop Gears'
program :version, '1.0.1'
program :description, 'Package management for Robot Sweatshop'
program :help, 'Author', 'Justin Scott <jvscott@gmail.com>'

default_command :help

command :init do |c|
  c.syntax = 'sweatshop-gears init'
  c.description = 'Makes the Gears packages available to Robot Sweatshop'
  c.option '--path STRING', String, 'The working path for downloading packages'
  c.action do |_args, options|
    options.default path: '/opt/gears'
    Gears.download to_path: options.path
    Gears.create_runtime_paths
    Gears::Dependencies.install from_path: options.path
    Gears::Binaries.expose from_path: options.path
    Gears::Services.load from_path: options.path
  end
end
